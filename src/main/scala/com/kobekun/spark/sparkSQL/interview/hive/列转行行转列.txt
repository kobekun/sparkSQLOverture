
列转行 走MapReduce
create table lie_hang(user_id string, order_id string) row format delimited fields terminated by '\t';
load data inpath '/kobekun/columntorow.txt' into table lie_hang;

select user_id,concat_ws(',',collect_list(order_id)) as order_id_list from lie_hang group by user_id limit 10;

user_id order_id_list
104399  1715131,2105395,1758844,981085,2444143,1458638,968412
104400  1609001,2986088,1795054

行转列  不走MapReduce
create table hang_lie(user_id string, order_value string) row format delimited fields terminated by '\t';
load data inpath '/kobekun/rowtocolumn.txt' into table hang_lie;

select user_id,order_value,order_id from hang_lie lateral view explode(split(order_value,',')) num as order_id limit 10;

user_id order_value     order_id
104408  2909888,2662805,2922438,674972,2877863,190237   2909888
104408  2909888,2662805,2922438,674972,2877863,190237   2662805
104408  2909888,2662805,2922438,674972,2877863,190237   2922438
104408  2909888,2662805,2922438,674972,2877863,190237   674972
104408  2909888,2662805,2922438,674972,2877863,190237   2877863
104408  2909888,2662805,2922438,674972,2877863,190237   190237
104407  2982655,814964,1484250,2323912,2689723,2034331,1692373,677498,156562,2862492,338128     2982655
104407  2982655,814964,1484250,2323912,2689723,2034331,1692373,677498,156562,2862492,338128     814964
104407  2982655,814964,1484250,2323912,2689723,2034331,1692373,677498,156562,2862492,338128     1484250
104407  2982655,814964,1484250,2323912,2689723,2034331,1692373,677498,156562,2862492,338128     2323912